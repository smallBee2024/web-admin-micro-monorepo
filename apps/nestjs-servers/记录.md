## pipe 管道

管道能做什么，

自带九个开箱即用的管道，即

- `ValidationPipe`
- `ParseIntPipe`
- `ParseFloatPipe`
- `ParseBoolPipe`
- `ParseArrayPipe`
- `ParseUUIDPipe`
- `ParseEnumPipe`
- `DefaultValuePipe`
- `ParseFilePipe`

#### 内置验证管道

提醒一句，您不必自己构建通用验证管道，因为 Nest 提供了开箱即用的 `ValidationPipe`。 内置的 `ValidationPipe` 提供了比我们在本章中构建的示例更多的选项，为了说明定制管道的机制，该示例保持基本状态。您可以在[此处](https://nestjs.inode.club/techniques/validation)找到完整的详细信息以及大量示例。

```ts
// 全局验证管道
  app.useGlobalPipes(new ValidationPipe({
    whitelist: true, // 自动删除非白名单属性
    forbidNonWhitelisted: false, // 如果设置为 true, 非白名单属性将导致请求失败
    transform: true, // 自动将普通对象转换为 DTO 实例
    transformOptions: {
      enableImplicitConversion: true, // 允许隐式类型转换
    },
    // 详细的错误响应
    exceptionFactory: (errors) => {
      const messages = errors.map(error => ({
        property: error.property,
        constraints: error.constraints,
      }));
      return new HttpException(
        {
          statusCode: 400,
          message: 'Validation failed',
          errors: messages,
        },
        400,
      );
    },
  }));
```



## 守卫使用：

